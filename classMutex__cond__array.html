<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: Mutex_cond_array Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">Mutex_cond_array Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="Mutex_cond_array" -->
<p><code>#include &lt;<a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a>&gt;</code></p>

<p><a href="classMutex__cond__array-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>Mutex_cond</b></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A mutex/cond pair. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a7daf69af88f2693e9d8ba87a5fa59c2b">Mutex_cond_array</a> (<a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *global_lock)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9dd09088240c27e11c270c43ff6c212b"></a><!-- doxytag: member="Mutex_cond_array::~Mutex_cond_array" ref="a9dd09088240c27e11c270c43ff6c212b" args="()" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a9dd09088240c27e11c270c43ff6c212b">~Mutex_cond_array</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy this object. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac3e2ae5454a39a9b29259bf30cd7cb7e"></a><!-- doxytag: member="Mutex_cond_array::lock" ref="ac3e2ae5454a39a9b29259bf30cd7cb7e" args="(int n) const " -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#ac3e2ae5454a39a9b29259bf30cd7cb7e">lock</a> (int n) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock the n'th mutex. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa00d13e13f3ad768bd3ae3fe95acd7d4"></a><!-- doxytag: member="Mutex_cond_array::unlock" ref="aa00d13e13f3ad768bd3ae3fe95acd7d4" args="(int n) const " -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#aa00d13e13f3ad768bd3ae3fe95acd7d4">unlock</a> (int n) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock the n'th mutex. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1dd2cf64be75681ec1e13e8416bbeb19"></a><!-- doxytag: member="Mutex_cond_array::broadcast" ref="a1dd2cf64be75681ec1e13e8416bbeb19" args="(int n) const " -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a1dd2cf64be75681ec1e13e8416bbeb19">broadcast</a> (int n) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcast the n'th condition. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a09f60861a1433f32e48b4cc4af349e8b">assert_owner</a> (int n) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#ac6424deffca449b32e6d0338c10a7a92">assert_not_owner</a> (int n) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a04097201197f39439ba4a5758aef0933">wait</a> (int n) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3b88400d8a7ac2ee797c83174035ff18"></a><!-- doxytag: member="Mutex_cond_array::enter_cond" ref="a3b88400d8a7ac2ee797c83174035ff18" args="(THD *thd, int n, PSI_stage_info *stage, PSI_stage_info *old_stage) const " -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a3b88400d8a7ac2ee797c83174035ff18">enter_cond</a> (THD *thd, int n, PSI_stage_info *stage, PSI_stage_info *old_stage) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute THD::enter_cond for the n'th condition variable. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a957daf939ff01d7b7ec3c104d230ec63"></a><!-- doxytag: member="Mutex_cond_array::get_max_index" ref="a957daf939ff01d7b7ec3c104d230ec63" args="() const " -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a957daf939ff01d7b7ec3c104d230ec63">get_max_index</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the greatest addressable index in this <a class="el" href="classMutex__cond__array.html">Mutex_cond_array</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum_return_status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMutex__cond__array.html#a36690cb3001e20bc5900abce919ea4e1">ensure_index</a> (int n)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Represents a growable array where each element contains a mutex and a condition variable.</p>
<p>Each element can be locked, unlocked, broadcast, or waited for, and it is possible to call "THD::enter_cond" for the condition. The allowed indexes range from 0, inclusive, to <a class="el" href="classMutex__cond__array.html#a957daf939ff01d7b7ec3c104d230ec63" title="Return the greatest addressable index in this Mutex_cond_array.">get_max_index()</a>, inclusive. Initially there are zero elements (and <a class="el" href="classMutex__cond__array.html#a957daf939ff01d7b7ec3c104d230ec63" title="Return the greatest addressable index in this Mutex_cond_array.">get_max_index()</a> returns -1); more elements can be allocated by calling <a class="el" href="classMutex__cond__array.html#a36690cb3001e20bc5900abce919ea4e1">ensure_index()</a>.</p>
<p>This data structure has a read-write lock that protects the number of elements. The lock is provided by the invoker of the constructor and it is generally the caller's responsibility to acquire the read lock. Access methods assert that the caller already holds the read (or write) lock. If a method of this class grows the number of elements, then the method temporarily upgrades this lock to a write lock and then degrades it to a read lock again; there will be a short period when the lock is not held at all. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7daf69af88f2693e9d8ba87a5fa59c2b"></a><!-- doxytag: member="Mutex_cond_array::Mutex_cond_array" ref="a7daf69af88f2693e9d8ba87a5fa59c2b" args="(Checkable_rwlock *global_lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMutex__cond__array.html#a7daf69af88f2693e9d8ba87a5fa59c2b">Mutex_cond_array::Mutex_cond_array</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *&#160;</td>
          <td class="paramname"><em>global_lock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a new <a class="el" href="classMutex__cond__array.html">Mutex_cond_array</a>.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">global_lock</td><td>Read-write lock that protects updates to the number of elements. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ac6424deffca449b32e6d0338c10a7a92"></a><!-- doxytag: member="Mutex_cond_array::assert_not_owner" ref="ac6424deffca449b32e6d0338c10a7a92" args="(int n) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMutex__cond__array.html#ac6424deffca449b32e6d0338c10a7a92">Mutex_cond_array::assert_not_owner</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Assert that this thread does not own the n'th mutex. This is a no-op if DBUG_OFF is on. </p>

</div>
</div>
<a class="anchor" id="a09f60861a1433f32e48b4cc4af349e8b"></a><!-- doxytag: member="Mutex_cond_array::assert_owner" ref="a09f60861a1433f32e48b4cc4af349e8b" args="(int n) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMutex__cond__array.html#a09f60861a1433f32e48b4cc4af349e8b">Mutex_cond_array::assert_owner</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Assert that this thread owns the n'th mutex. This is a no-op if DBUG_OFF is on. </p>

</div>
</div>
<a class="anchor" id="a36690cb3001e20bc5900abce919ea4e1"></a><!-- doxytag: member="Mutex_cond_array::ensure_index" ref="a36690cb3001e20bc5900abce919ea4e1" args="(int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum_return_status <a class="el" href="classMutex__cond__array.html#a36690cb3001e20bc5900abce919ea4e1">Mutex_cond_array::ensure_index</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Grows the array so that the given index fits.</p>
<p>If the array is grown, the global_lock is temporarily upgraded to a write lock and then degraded again; there will be a short period when the lock is not held at all.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>The index. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>RETURN_OK or RETURN_REPORTED_ERROR </dd></dl>

</div>
</div>
<a class="anchor" id="a04097201197f39439ba4a5758aef0933"></a><!-- doxytag: member="Mutex_cond_array::wait" ref="a04097201197f39439ba4a5758aef0933" args="(int n) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classMutex__cond__array.html#a04097201197f39439ba4a5758aef0933">Mutex_cond_array::wait</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Wait for signal on the n'th condition variable.</p>
<p>The caller must hold the read lock or write lock on sid_lock, as well as the nth mutex lock, before invoking this function. The sid_lock will be released, whereas the mutex will be released during the wait and (atomically) re-acquired when the wait ends. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a></li>
<li>rpl_gtid_mutex_cond_array.cc</li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 16 2015 12:37:03 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
