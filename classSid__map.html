<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: Sid_map Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">Sid_map Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="Sid_map" -->
<p><code>#include &lt;<a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a>&gt;</code></p>

<p><a href="classSid__map-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>Node</b></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Node pointed to by both the hash and the array. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#adcb420a3241258cc68ab42910133144d">Sid_map</a> (<a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *sid_lock)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a02ebe48caba52d2bccd668088c25a8e8"></a><!-- doxytag: member="Sid_map::~Sid_map" ref="a02ebe48caba52d2bccd668088c25a8e8" args="()" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a02ebe48caba52d2bccd668088c25a8e8">~Sid_map</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy this <a class="el" href="classSid__map.html">Sid_map</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a23aa9c0f385a44772e9e5c3955cca0cf">add_sid</a> (const <a class="el" href="structUuid.html">rpl_sid</a> &amp;sid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a5463e9ffa0cbdfe02fbd7a322590b646">sid_to_sidno</a> (const <a class="el" href="structUuid.html">rpl_sid</a> &amp;sid) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structUuid.html">rpl_sid</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a945ea7eccbb14052aa4bd84e5e44545c">sidno_to_sid</a> (rpl_sidno sidno) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#ac62d7fb30ad41dacd77ea0ef842e5d70">get_sorted_sidno</a> (rpl_sidno n) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a7bb52a993792edff5d2348c728fb5a08">get_max_sidno</a> () const </td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Represents a bidirectional map between SID and SIDNO.</p>
<p>SIDNOs are always numbers greater or equal to 1.</p>
<p>This data structure OPTIONALLY knows of a read-write lock that protects the number of SIDNOs. The lock is provided by the invoker of the constructor and it is generally the caller's responsibility to acquire the read lock. If the lock is not NULL, access methods assert that the caller already holds the read (or write) lock. If the lock is not NULL and a method of this class grows the number of SIDNOs, then the method temporarily upgrades this lock to a write lock and then degrades it to a read lock again; there will be a short period when the lock is not held at all. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="adcb420a3241258cc68ab42910133144d"></a><!-- doxytag: member="Sid_map::Sid_map" ref="adcb420a3241258cc68ab42910133144d" args="(Checkable_rwlock *sid_lock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSid__map.html#adcb420a3241258cc68ab42910133144d">Sid_map::Sid_map</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *&#160;</td>
          <td class="paramname"><em>sid_lock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create this <a class="el" href="classSid__map.html">Sid_map</a>.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sid_lock</td><td>Read-write lock that protects updates to the number of SIDNOs. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a23aa9c0f385a44772e9e5c3955cca0cf"></a><!-- doxytag: member="Sid_map::add_sid" ref="a23aa9c0f385a44772e9e5c3955cca0cf" args="(const rpl_sid &amp;sid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno <a class="el" href="classSid__map.html#a23aa9c0f385a44772e9e5c3955cca0cf">Sid_map::add_sid</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structUuid.html">rpl_sid</a> &amp;&#160;</td>
          <td class="paramname"><em>sid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add the given SID to this map if it does not already exist.</p>
<p>The caller must hold the read lock or write lock on sid_lock before invoking this function. If the SID does not exist in this map, it will release the read lock, take a write lock, update the map, release the write lock, and take the read lock again.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sid</td><td>The SID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">SIDNO</td><td>The SIDNO for the SID (a new SIDNO if the SID did not exist, an existing if it did exist). </td></tr>
    <tr><td class="paramname">negative</td><td>Error. This function calls my_error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7bb52a993792edff5d2348c728fb5a08"></a><!-- doxytag: member="Sid_map::get_max_sidno" ref="a7bb52a993792edff5d2348c728fb5a08" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno <a class="el" href="classSid__map.html#a7bb52a993792edff5d2348c728fb5a08">Sid_map::get_max_sidno</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the biggest sidno in this <a class="el" href="classSid__map.html">Sid_map</a>.</p>
<p>The caller must hold the read or write lock on sid_lock before invoking this function. </p>

</div>
</div>
<a class="anchor" id="ac62d7fb30ad41dacd77ea0ef842e5d70"></a><!-- doxytag: member="Sid_map::get_sorted_sidno" ref="ac62d7fb30ad41dacd77ea0ef842e5d70" args="(rpl_sidno n) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno <a class="el" href="classSid__map.html#ac62d7fb30ad41dacd77ea0ef842e5d70">Sid_map::get_sorted_sidno</a> </td>
          <td>(</td>
          <td class="paramtype">rpl_sidno&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the n'th smallest sidno, in the order of the SID's UUID.</p>
<p>The caller must hold the read or write lock on sid_lock before invoking this function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>A number in the interval [0, <a class="el" href="classSid__map.html#a7bb52a993792edff5d2348c728fb5a08">get_max_sidno()</a>-1], inclusively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5463e9ffa0cbdfe02fbd7a322590b646"></a><!-- doxytag: member="Sid_map::sid_to_sidno" ref="a5463e9ffa0cbdfe02fbd7a322590b646" args="(const rpl_sid &amp;sid) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno <a class="el" href="classSid__map.html#a5463e9ffa0cbdfe02fbd7a322590b646">Sid_map::sid_to_sidno</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structUuid.html">rpl_sid</a> &amp;&#160;</td>
          <td class="paramname"><em>sid</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the SIDNO for a given SID</p>
<p>The caller must hold the read lock on sid_lock before invoking this function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sid</td><td>The SID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">SIDNO</td><td>if the given SID exists in this map. </td></tr>
    <tr><td class="paramname">0</td><td>if the given SID does not exist in this map. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a945ea7eccbb14052aa4bd84e5e44545c"></a><!-- doxytag: member="Sid_map::sidno_to_sid" ref="a945ea7eccbb14052aa4bd84e5e44545c" args="(rpl_sidno sidno) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structUuid.html">rpl_sid</a>&amp; <a class="el" href="classSid__map.html#a945ea7eccbb14052aa4bd84e5e44545c">Sid_map::sidno_to_sid</a> </td>
          <td>(</td>
          <td class="paramtype">rpl_sidno&#160;</td>
          <td class="paramname"><em>sidno</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the SID for a given SIDNO.</p>
<p>An assertion is raised if the caller does not hold a lock on sid_lock, or if the SIDNO is not valid.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sidno</td><td>The SIDNO. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>The SIDNO does not exist in this map. </td></tr>
    <tr><td class="paramname">pointer</td><td>Pointer to the SID. The data is shared with this <a class="el" href="classSid__map.html">Sid_map</a>, so should not be modified. It is safe to read the data even after this <a class="el" href="classSid__map.html">Sid_map</a> is modified, but not if this <a class="el" href="classSid__map.html">Sid_map</a> is destroyed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a></li>
<li>rpl_gtid_sid_map.cc</li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 16 2015 12:37:14 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
